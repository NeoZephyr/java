OOM 可能性
堆内存持续上升，死循环导致这个线程的资源无法释放，请求响应码为 504

分代回收法

分代回收算法实际上是把复制算法和标记整理法的结合，并不是真正一个新的算法，一般分为：老年代（Old Generation）和新生代（Young Generation），老年代就是很少垃圾需要进行回收的，新生代就是有很多的内存空间需要回收，所以不同代就采用不同的回收算法，以此来达到高效的回收算法。
新生代：由于新生代产生很多临时对象，大量对象需要进行回收，所以采用复制算法是最高效的。
老年代：回收的对象很少，都是经过几次标记后都不是可回收的状态转移到老年代的，所以仅有少量对象需要回收，故采用标记清除或者标记整理算法。
所以以上整个过程就达到了最高效的回收办法。

注意：新生代与老年代分配的比例为 2：1



jmap -heap <pid>
查看存活对象大小，会强制进行一次 fullgc
jmap -histo:live <pid> | more

寻找最耗 CPU 的进程
显示进程运行信息列表
top -c
键入 P 进程按照 CPU 使用率排序

寻找最耗 CPU 的线程
top -Hp <pid>
键入 P 线程按照 CPU 使用率排序

将线程 pid 转换为 16 进制
printf "%x\n" <pid>

查看堆栈，找到该线程
jstack <pid> | grep '16 进制线程号' -C5 --color




CMS
如果老年代使用CMS垃圾回收器，需要添加虚拟机参数-"XX:+UseConcMarkSweepGC"
缺点：
服务长时间运行，造成严重的内存碎片化

